<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Welcome extends CI_Controller {
	
  public function __construct()
  {
    parent::__construct();
    $this->load->model('mem');
  } 
	
	public function fee_insert() 
	{  
		$this->load->library('session');
		if($this->session->userdata('logged_in') != TRUE)
		{
			$this->load->view('login'); 
			return;
		}
		 
	  $this->load->view('header');  
    $data['username'] = $this->mem->set_fees();
		$this->load->view('welcome_message' , $data);
		$this->load->view('footer'); 
   }
  
	public function fee()
	{
		$this->load->library('session');
		if($this->session->userdata('logged_in') != TRUE)
		{
			$this->load->view('login'); 
			return;
		}
	  $this->load->helper('form');
	  $this->load->library('form_validation');
	  
	  $this->form_validation->set_rules('text', 'text', 'required');
	  
	  if ($this->form_validation->run() === FALSE)
		{
	    $this->load->view('header');  
	    $this->load->view('fee');
	    $this->load->view('footer'); 
	  }
	  else
	  {
				$data['username'] = "form_validation->run()";
		    $this->load->view('header');  
				$this->load->view('welcome_message' , $data);
		    $this->load->view('footer'); 
	  }
	}
  
	public function create()
	{
		$this->load->library('session');
		if($this->session->userdata('logged_in') != TRUE)
		{
			$this->load->view('login'); 
			return;
		}
	  $this->load->helper('form');
	  $this->load->library('form_validation');
	  
	  $this->form_validation->set_rules('text', 'text', 'required');
	  
	  if ($this->form_validation->run() === FALSE)
		{
	    $this->load->view('header');  
	    $this->load->view('create');
	    $this->load->view('footer'); 
	  }
	  else
	  {
				$data['username'] = "form_validation->run()";
		    $this->load->view('header');  
				$this->load->view('welcome_message' , $data);
		    $this->load->view('footer'); 
	  }
	}
	
  public function view_js($slug = FALSE)
  {
		$this->load->library('session');
		if($this->session->userdata('logged_in') != TRUE)
		{
			$this->load->view('login'); 
			return;
		} 
		if($slug != FALSE )
		{
    	$data['news_item'] = $this->mem->get_news($slug);
    }

	  if (empty($data['news_item']))
	  {
			$this->load->view('login'); 
			return;
	  }
		if($slug != FALSE )
		{
    	$data['fee_item'] = $this->mem->get_fees($data['news_item']['unique_name']);
    }
		$this->load->view('detail_js' , $data);
  }
	
  public function view($slug = FALSE)
  {
		$this->load->library('session');
		if($this->session->userdata('logged_in') != TRUE)
		{
			$this->load->view('login'); 
			return;
		} 
		if($slug != FALSE )
		{
    	$data['news_item'] = $this->mem->get_news($slug);
    }

	  if (empty($data['news_item']))
	  {
			$this->load->view('login'); 
			return;
	  }
		if($slug != FALSE )
		{
    	$data['fee_item'] = $this->mem->get_fees($data['news_item']['unique_name']);
    }
		$this->load->view('header');  
		$this->load->view('detail' , $data);
		$this->load->view('footer'); 
  }
	
	public function all() 
	{  
		$this->load->library('session');
		if($this->session->userdata('logged_in') != TRUE)
		{
			$this->load->view('login'); 
			return;
		}
		$this->load->view('header');  
    //$this->mem->set_news();
    $data['news'] = $this->mem->get_news();
		$this->load->view('news' , $data);
		$this->load->view('footer'); 
	}
	
	public function index($user = FALSE , $mm = FALSE)
	{
		$this->load->library('session');
		header("Content-type:text/html;charset=utf-8");
		if ($user === FALSE || $mm === FALSE)
		{
			if($this->session->userdata('logged_in') === TRUE)
			{
				$data['username'] = $this->session->userdata('username');
		    $this->load->view('header');  
				$this->load->view('welcome_message' , $data);
		    $this->load->view('footer'); 
			}
			else
				$this->load->view('login'); 
			return;
		}
		
		if ($user === 'zxy' && $mm === "asd")
		{
			$newdata = array(
                   'username'  => $user,
                   'logged_in' => TRUE
               );

			$this->session->set_userdata($newdata);
			$data['username'] = $this->session->userdata('username');
		  $this->load->view('header');  
			$this->load->view('welcome_message' , $data);
		  $this->load->view('footer'); 
			return;
		}
		
		$this->load->view('login'); 
	}
}

/* End of file welcome.php */
/* Location: ./application/controllers/welcome.php */